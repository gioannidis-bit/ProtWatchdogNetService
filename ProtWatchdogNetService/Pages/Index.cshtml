@page
@model ProtWatchdog.Pages.IndexModel
<!doctype html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prot Watchdog</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/water.css@2/out/water.css">
    <style>
        body {
            max-width: 1400px;
        }

        form#addForm {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

            form#addForm label {
                display: flex;
                flex-direction: column;
            }

            form#addForm input {
                margin-top: 5px;
            }

            form#addForm button {
                grid-column: 1 / -1;
            }

        /* Responsive table wrapper */
        .table-wrapper {
            overflow-x: auto;
            margin-top: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }

            table th, table td {
                padding: 10px;
                text-align: left;
                border: 1px solid #ddd;
            }

            table th {
                background-color: #f5f5f5;
                font-weight: bold;
            }

            table tr:hover {
                background-color: #f9f9f9;
            }

        .status-running {
            color: green;
            font-weight: bold;
        }

        .status-stopped {
            color: red;
            font-weight: bold;
        }

        .mono {
            font-family: monospace;
            font-size: 0.9em;
        }

        button.remove-btn {
            background-color: #d9534f;
            color: white;
            border: none;
            padding: 5px 10px;
            cursor: pointer;
            border-radius: 3px;
        }

            button.remove-btn:hover {
                background-color: #c9302c;
            }

        .action-buttons {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }

        .action-btn {
            border: none;
            padding: 5px 10px;
            cursor: pointer;
            border-radius: 3px;
            font-size: 0.85em;
            color: white;
        }

        .start-btn {
            background-color: #5cb85c;
        }

            .start-btn:hover {
                background-color: #4cae4c;
            }

        .stop-btn {
            background-color: #d9534f;
        }

            .stop-btn:hover {
                background-color: #c9302c;
            }

        .restart-btn {
            background-color: #f0ad4e;
        }

            .restart-btn:hover {
                background-color: #ec971f;
            }

        .restart-btn {
            background-color: #f0ad4e;
        }

            .restart-btn:hover {
                background-color: #ec971f;
            }

        .remove-btn {
            background-color: #777;
        }

            .remove-btn:hover {
                background-color: #555;
            }

        @@media (max-width: 768px) {
            form #addForm

        {
            grid-template-columns: 1fr;
        }

        }</style>
</head>
<body>
    <h1>üêï Prot Watchdog - Web UI</h1>

    <h2>Add New Process</h2>
    <form id="addForm">
        <label>
            Name:
            <input type="text" id="name" required placeholder="My App">
        </label>
        <label>
            Executable Path:
            <input type="text" id="exe" required placeholder="C:\path\to\app.exe">
        </label>
        <label>
            Parameters:
            <input type="text" id="params" placeholder="--flag value">
        </label>
        <label>
            Restart Delay (seconds):
            <input type="number" id="delay" value="5" min="1">
        </label>
        <label>
            Max Restart Attempts:
            <input type="number" id="maxRestarts" value="10" min="1" title="Maximum restarts within time window">
        </label>
        <label>
            Time Window (minutes):
            <input type="number" id="timeWindow" value="5" min="1" title="Time window for restart counting">
        </label>

        <hr style="grid-column: 1 / -1; margin: 10px 0;">
        <h3 style="grid-column: 1 / -1; margin: 5px 0;">Health Monitoring (Optional)</h3>

        <label>
            <input type="checkbox" id="enableHealth"> Enable Health Check
        </label>
        <label>
            Health Check Interval (s):
            <input type="number" id="healthInterval" value="30" min="10">
        </label>
        <label>
            Max Memory (MB, 0=disabled):
            <input type="number" id="maxMemory" value="0" min="0" step="100">
        </label>
        <label>
            Max CPU (%, 0=disabled):
            <input type="number" id="maxCpu" value="0" min="0" max="100">
        </label>
        <label>
            Min CPU (%, 0=disabled):
            <input type="number" id="minCpu" value="0" min="0" max="100" title="Zombie detection">
        </label>
        <label>
            Unhealthy Threshold (s):
            <input type="number" id="unhealthyThreshold" value="60" min="10" title="How long unhealthy before restart">
        </label>

        <button type="submit">‚ûï Add Process</button>
    </form>

    <h2>Managed Processes (<span id="processCount">0</span>)</h2>
    <div class="table-wrapper">
        <table id="table">
            <thead>
                <tr>
                    <th>Status</th>
                    <th>Name</th>
                    <th>PID</th>
                    <th>Executable</th>
                    <th>Parameters</th>
                    <th>Restart Delay</th>
                    <th>Last Start</th>
                    <th>Restarts</th>
                    <th>Recent Restarts</th>
                    <th>Exit Code</th>
                    <th>Auto-Restart</th>
                    <th>Circuit Breaker</th>
                    <th>Health</th>
                    <th>CPU %</th>
                    <th>Memory MB</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <script src="/app.js"></script>
</body>
</html>